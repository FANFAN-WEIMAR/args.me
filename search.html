<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="css/search.css"/>
<title>Results</title>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
 <script src="http://cdnjs.cloudflare.com/ajax/libs/mathjs/3.18.1/math.min.js"></script>
<script src="js/mds.js"></script>
<script src="js/barycentric.js"></script>

<script type="text/javascript">

	window.onload=function(){
		var queryString=window.location.search.replace(/^\?/,'');
		searchText.placeholder=queryString;
		search(queryString);
    check();
	}

	function searchQuery(){
		var searchValue=document.getElementById('searchText').value;
		window.location="./search.html?"+searchValue;
		search(searchValue);
	}

	function search(searchValue){
		var apiURL="http://141.54.172.105:8081/api/v1/_search?query=" + searchValue ;
		$.getJSON(apiURL,function(data){
			var length=data.results.length;
			var conclusion;
			var stance;
			var div=document.getElementById('resultDisplay');
			var divPro=document.getElementById('Pro');
			var divCon=document.getElementById('Con');

			while(divPro.firstChild){
				divPro.removeChild(divPro.firstChild);
			}
			while(divCon.firstChild){
				divCon.removeChild(divCon.firstChild);
			}


			for(var i=0;i<length;i++){
				conclusion=data.results[i].conclusion;
				stance=data.results[i].stance;
				if(stance==true){
					var iDiv = document.createElement('div');
					iDiv.innerHTML=conclusion;
					div.appendChild(iDiv);
					document.getElementById('Pro').appendChild(iDiv);
				}else{
					var iDiv = document.createElement('div');
					iDiv.innerHTML=conclusion;
					div.appendChild(iDiv);
					document.getElementById('Con').appendChild(iDiv);
				}
			}
		})
	}
	function remove(id){
		var element =document.getElementById('id');
		element.parentNode.removeChild(element);
	}
</script>

</head>

<body>
	<div id="container">
		<div id="header">
			<h1>Args.me</h1>
			<div class="SearchContainer">
					<input id="searchText" type="text" class="searchTerm"/>
					<button type="submit" class="searchButton" onclick="searchQuery()"/>Go!</button>
			</div>
		</div>
		<div id="body">

			<div id="resultDisplay">
				<div id="Pro"></div><div id="Con"></div>
				<div id="euclideanDistance">Euclidean Distance</div>
				<div id="KLDistance">KL Distance</div>
				<div id="CosineSimilarity">CosineSimilarity</div>
				<div id="polygon">polygon</div>
				<form id="checkbox">
						<input  type="checkbox" name="topics" value="topic1" checked="checked" onclick="check()"/>topic1
						<input  type="checkbox" name="topics" value="topic2" checked="checked" onclick="check()"/>topic2
						<input  type="checkbox" name="topics" value="topic3" checked="checked" onclick="check()"/>topic3
						<input  type="checkbox" name="topics" value="topic4" checked="checked" onclick="check()"/>topic4
						<input  type="checkbox" name="topics" value="topic5" checked="checked" onclick="check()"/>topic5
						<input  type="checkbox" name="topics" value="topic6" checked="checked" onclick="check()"/>topic6
				</form>
			</div>
		</div>
		<div id="footer">
			<ul>
        	<li class="float-left"><a href="">HELP</a></li>
          <li class="float-left"><a href="">TERMS</a></li>
          <li class="float-left"><a href="">PRIVACY</a></li>
          <li class="float-left"><a href="">API</a></li>
          <li class="float-right"><a href="">ABOUT</a></li>
          <li class="float-right"><a href="">@2017WEBIS</a></li>
        </ul>
		</div>
	</div>

<script>
  function check(){

    var Polygon=document.getElementById('polygon');

    while(Polygon.firstChild){
      Polygon.removeChild(Polygon.firstChild);
    }


    //console.log(cityData);
    var col=cityData[0].length;
    var row=cityData.length;

    var checkedTopics=[];
    var topics=document.getElementsByName('topics');
      for(var i=0;i<topics.length;i++){
        if(topics[i].checked){
          checkedTopics.push(i);
        }
      }
    //console.log(checkedTopics);

    var processedData=[];
    var processedLabel=[];
    for(var i=0;i<row;i++){
      processedData[i]=new Array(checkedTopics.length);
    }

    for (var a=0;a<row;a++){
      for (var b=0;b<checkedTopics.length;b++){
        processedData[a][b]=cityData[a][checkedTopics[b]];
      }
    }
    //console.log(processedData);

    var emptySample=[];
    for(var i=0;i<checkedTopics.length;i++){
      emptySample[i]=0;
    }
    //console.log(emptySample);

    // var index=processedData.indexOf(emptySample);
    // console.log(index);
    //processedData.splice(processedData.indexOf(emptySample),1);
    // var processedDataWithoutNull=[];
    // for(var a=0;a<processedData.length;a++){
    //   if(processedData[a]!=emptySample){
    //     processedDataWithoutNull.push(processedData[a]);
    //   }
    // }
    // console.log(processedDataWithoutNull);

    for(var a=0;a<checkedTopics.length;a++){
      processedLabel[a]=labels[checkedTopics[a]]
    }

    var verticesNumber=processedLabel.length;
		polygon(processedData,d3.select('#polygon'),150,verticesNumber,processedLabel);


  }
</script>
<script>

var cityData = [[16, 1, 1, 1, 1, 1],
    [1, 10, 1, 1, 1, 1],
    [1, 1, 1, 9, 1, 1],
    [1, 1, 1, 1, 8, 8],
    [0, 0, 1, 0, 16, 0],
    [1, 1, 1, 1, 1, 1]]
var labels = [
    'topic1',
    'topic2',
    'topic3',
    'topic4',
    'topic5',
    'topic6'];
  //console.log(cityData);
  //
	// var cityPositions = numeric.transpose(mds.classic(cityData));
	// //console.log(mds.classic(cityData));
	// //console.log(cityPositions);
	// var w = Math.min(600, document.documentElement.clientWidth - 20),
	//     h = w /2;
	// mds.drawD3ScatterPlot(d3.select("#euclideanDistance"),
	//     cityPositions[0],
	//     cityPositions[1],
	//     labels,
	//     {
	//         w :  Math.min(600, document.documentElement.clientWidth - 20),
	//         h : w /2,
	//         padding : 37,
	//         reverseX : true,
	//         reverseY : true,
	//     });
  //
	// var cityPositions = numeric.transpose(mds.KL(cityData));
	// //console.log(cityPositions);
	// var w = Math.min(600, document.documentElement.clientWidth - 20),
	// 		h = w /2;
	// mds.drawD3ScatterPlot(d3.select("#KLDistance"),
	// 		cityPositions[0],
	// 		cityPositions[1],
	// 		labels,
	// 		{
	// 				w :  Math.min(600, document.documentElement.clientWidth -20),
	// 				h : w /2,
	// 				padding : 37,
	// 				reverseX : true,
	// 				reverseY : true,
	// 		});
  //
	// 	var cityPositions = numeric.transpose(mds.Cosin(cityData));
	// 	//console.log(cityPositions);
	// 	var w = Math.min(600, document.documentElement.clientWidth - 20),
	// 			h = w /2;
	// 	mds.drawD3ScatterPlot(d3.select("#CosineSimilarity"),
	// 			cityPositions[0],
	// 			cityPositions[1],
	// 			labels,
	// 			{
	// 					w :  Math.min(600, document.documentElement.clientWidth -20),
	// 					h : w /2,
	// 					padding : 37,
	// 					reverseX : true,
	// 					reverseY : true,
	// 			});
	// </script>


</body>
</html>
